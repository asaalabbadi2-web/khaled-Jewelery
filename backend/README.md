# โ๏ธ ููุงุญุธุฉ ูุงูุฉ ุฌุฏุงู - IMPORTANT

## ๐ด ูุฌุจ ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ุฃููุงู!

**ูุจู ุชุดุบูู ุฃู ููู Python ูู ูุฐุง ุงููุฌูุฏุ ูุฌุจ ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ:**

```bash
# ุงูุฎุทูุฉ 1: ุงูุงูุชูุงู ูููุฌูุฏ
cd /Users/salehalabbadi/yasargold/backend

# ุงูุฎุทูุฉ 2: ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ (ุฅูุฒุงูู!)
source venv/bin/activate

# ุงูุฎุทูุฉ 3: ุงูุขู ููููู ุชุดุบูู ุฃู ุฃูุฑ Python
python app.py
python test_invoices.py
alembic upgrade head
# ... ุฅูุฎ
```

**ุนูุงูุฉ ุงูุชูุนูู:** ุณุชุธูุฑ `(venv)` ูู ุจุฏุงูุฉ ุณุทุฑ ุงูุฃูุงูุฑ ุนูุฏ ุงูุชูุนูู ุงููุงุฌุญ.

---

## ููุงุญุธุฉ ูุงูุฉ

### ุชุนูููุงุช ุฅุฏุฎุงู ุงูุจูุงูุงุช ุจุงููุฒู

- ุฌููุน ุงูุญููู ุงูุฃุณุงุณูุฉ (ุงููุฒูุ ุงูุนูุงุฑุ ุงูุฃุฌุฑุฉ) ูุฌุจ ุฅุฏุฎุงููุง ุจูุญุฏุฉ ุงููุฒู (ุบุฑุงู) ูููุณ ุจุงูููุฏูุฉ.
- ุนูุฏ ุฅุฏุฎุงู ุตูู ุฌุฏูุฏ ุฃู ูุงุชูุฑุฉุ ุชุฃูุฏ ูู ุฅุฏุฎุงู ุงููุฒู ุงููุนูู ููุฐูุจุ ูุณูุชู ุชุญูููู ุชููุงุฆูุงู ุฅูู ุงูุนูุงุฑ ุงูุฑุฆูุณู.
- ุงูุฃุฌุฑุฉ ูุงููุตุงุฑูู ูุชู ุชุญููููุง ุฅูู ูุง ูุนุงุฏููุง ุจุงูุฐูุจ ุชููุงุฆูุงู.
- ุงูุชูุงุฑูุฑ ูุงูุฌุฑุฏ ุชุนุฑุถ ุญุฑูุฉ ุงูุฐูุจ ูุงูุฑุจุญ ูุงูุฎุณุงุฑุฉ ุจุงููุฒู.

---

## ุฃุฏูุงุช ูุณุงุนุฏุฉ

### ูุญุต ุฅุนุฏุงุฏุงุช ุงูุญุณุงุจุงุช ุงููุญุงุณุจูุฉ

ุงูุณูุฑูุจุช `check_mappings.py` ูุนุฑุถ ุชูุฑูุฑ ุดุงูู ุนู ุฅุนุฏุงุฏุงุช ุงูุญุณุงุจุงุช ุงููุญุงุณุจูุฉ:

```bash
# ุชูุนูู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ุฃููุงู
source venv/bin/activate

# ุชุดุบูู ุงููุญุต
python check_mappings.py
```

**ูุนุฑุถ ุงูุชูุฑูุฑ:**
- ุฌููุน ุงูุฅุนุฏุงุฏุงุช ุงูุญุงููุฉ ูุฌูุนุฉ ุญุณุจ ููุน ุงูุนูููุฉ
- ุงูุญุณุงุจุงุช ุงูุฃุณุงุณูุฉ ุงููุชููุฑุฉ
- ุงูุฅุนุฏุงุฏุงุช ุงููุงูุตุฉ ููู ููุน ุนูููุฉ

**ูุฅุถุงูุฉ ุฅุนุฏุงุฏุงุช ุฌุฏูุฏุฉ:**
ุงุณุชุฎุฏู API ุจุฏูุงู ูู ุงูุณูุฑูุจุช (ุงูุธุฑ `docs/accounting_mapping.md`)

---

## ุชูุงููู ุงูุฐูุจ ุงููุชุญุฑูุฉ (Moving Average Costing)

### ููุงุท ุฃุณุงุณูุฉ
- ุชุนุชูุฏ ุฌููุน ูููุฏ ุงููุฎุฒูู ุนูู ุงููุฒู ูุชุญูููู ููุนูุงุฑ ุงูุฑุฆูุณู (21).
- ูุชู ุฃุฎุฐ ููุทุฉ ูู ูุชูุณุท ุงูุชูููุฉ ุงูุญุงูู (`avg_cost_*`) ุนูุฏ ุฅูุดุงุก ุฃู ูุงุชูุฑุฉ ูุชุฎุฒูููุง ุฏุงุฎู ุฌุฏูู `invoice`.
- ุฎุฏูุฉ `GoldCostingService` ูุณุคููุฉ ุนู ุชุญุฏูุซ ุงููุชูุณุท ุนูุฏ ุงููุดุชุฑูุงุช ูุงุณุชููุงูู ุนูุฏ ุงููุจูุนุงุช ุฃู ุงููุฑุชุฌุนุงุช.

### ูุงุฌูุงุช ุจุฑูุฌูุฉ ุฌุฏูุฏุฉ

| Endpoint | ุงููุตู |
| --- | --- |
| `GET /api/gold-costing` | ุฅุฑุฌุงุน ุงููุชูุณุท ุงูุญุงูู ูุงูุฅุนุฏุงุฏุงุช ุงููุฎุฒูุฉ.
| `PUT /api/gold-costing` | ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุทุฑููุฉ ุงูุงุญุชุณุงุจ (ุญุงูููุง moving_average ููุท).
| `POST /api/gold-costing/cogs` | ุญุณุงุจ ุชูููุฉ ุงูุจุถุงุนุฉ ุงููุจุงุนุฉ ููุฒู ูุนูู ุจุงุณุชุฎุฏุงู ุงููุชูุณุท ุงูุญุงูู.
| `POST /api/gold-costing/recompute` | ุฅุนุงุฏุฉ ุจูุงุก ุงููุชูุณุท ูู ููุงุชูุฑ ุงูุดุฑุงุก ุงูุชุงุฑูุฎูุฉ (ููุงุณุชุฎุฏุงู ุงูุฅุฏุงุฑู).

### ุฎุฏูุฉ ุฃุฑุตุฏุฉ ุงูููุฑุฏูู ุจุงูุฐูุจ

| Endpoint | ุงููุตู |
| --- | --- |
| `GET /api/suppliers/<id>/gold-balance` | ุนุฑุถ ุฑุตูุฏ ููุฑุฏ ูู ุงูุฐูุจ ุงูููุงูุฆ.
| `GET /api/suppliers/<id>/gold-transactions` | ุณุฑุฏ ุฌููุน ุญุฑูุงุช ุงูุฐูุจ ุงูุฎุงุตุฉ ุจุงูููุฑุฏ.
| `POST /api/suppliers/<id>/gold-settlements` | ุชุณุฌูู ุชุณููุฉ ุฐูุจูุฉ ุฃู ููุฏูุฉ ูุน ุงูููุฑุฏ.

> **ููุงุญุธุฉ:** ูุชู ุงุณุชุฏุนุงุก `SupplierGoldService` ุชููุงุฆูุงู ุนูุฏ ููุงุชูุฑ ุดุฑุงุก ุงูููุฑุฏูู ุฃู ูุฑุชุฌุนุงุชูู ูุถูุงู ุชุทุงุจู ุงูุฑุตูุฏ.