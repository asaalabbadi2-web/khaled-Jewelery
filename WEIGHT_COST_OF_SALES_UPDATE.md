# ุชุญุฏูุซ ุชูููุฉ ุงููุจูุนุงุช ุงููุฒููุฉ โ

## ุงูุชุงุฑูุฎ: 14 ุฏูุณูุจุฑ 2025

## ุงููุฏู
ุชุทุจูู ุงูููุงุนุฏ ุงูุตุญูุญุฉ ูุญุณุงุจ ุชูููุฉ ุงููุจูุนุงุช ูู ุงููุธุงู ุงููุฒุฏูุฌ (ููุฏู + ูุฒูู).

---

## ๐ ุงูููุงุนุฏ ุงููุทุจูุฉ

### 1๏ธโฃ ุชูููุฉ ุงููุจูุนุงุช ุงูููุฏูุฉ (ูุญุงุณุจูุฉ)
```
ุชูููุฉ ุงููุจูุนุงุช ุงูููุฏูุฉ = (ุงููุฒู ุงููุจุงุน ร ูุชูุณุท ุชูููุฉ ุงูุฌุฑุงู) + ุงููุตูุนูุฉ ุงูููุฏูุฉ
```

**ูุซุงู:**
- ุงููุฒู ุงููุจุงุน: 10 ุฌู
- ูุชูุณุท ุงูุชูููุฉ: 250 ุฑ.ุณ/ุฌู
- ุงููุตูุนูุฉ: 500 ุฑ.ุณ
- **ุงูุชูููุฉ = (10 ร 250) + 500 = 2500 + 500 = 3000 ุฑ.ุณ**

---

### 2๏ธโฃ ุชูููุฉ ุงููุจูุนุงุช ุงููุฒููุฉ (ุชุญููููุฉ)
```
ุชูููุฉ ุงููุจูุนุงุช ุงููุฒููุฉ = ุงููุฒู ุงููุนูู ุงููุจุงุน + (ุงููุตูุนูุฉ รท ุงูุณุนุฑ ุงููุจุงุดุฑ)
```

**ูุซุงู:**
- ุงููุฒู ุงููุจุงุน: 10 ุฌู
- ุงููุตูุนูุฉ: 500 ุฑ.ุณ
- ุงูุณุนุฑ ุงููุจุงุดุฑ: 453.67 ุฑ.ุณ/ุฌู (ุนูุงุฑ 21)
- ุงููุตูุนูุฉ ุงููุฒููุฉ: 500 รท 453.67 = 1.102 ุฌู
- **ุงูุชูููุฉ ุงููุฒููุฉ = 10 + 1.102 = 11.102 ุฌู**

---

## ๐ง ุงูุชุนุฏููุงุช ุงููููุฐุฉ

### 1. ุชุญุฏูุซ ุชูููุฉ ุงููุจูุนุงุช ุงูููุฏูุฉ
**ุงูููู:** `backend/routes.py` (ุณุทูุฑ 2685-2710)

```python
# ุญุณุงุจ ุฅุฌูุงูู ุงููุตูุนูุฉ ูู items ู karat_lines
total_wage_cash_for_cost = 0.0

# ุงููุตูุนูุฉ ูู items
for item_data in data.get('items', []):
    item_wage = _to_float(item_data.get('wage', 0), 0.0)
    quantity = _to_float(item_data.get('quantity', 1), 1.0)
    total_wage_cash_for_cost += item_wage * quantity

# ุงููุตูุนูุฉ ูู karat_lines
if karat_lines_data and isinstance(karat_lines_data, list):
    for line_data in karat_lines_data:
        wage_cash = _to_float(line_data.get('manufacturing_wage_cash', 0), 0.0)
        total_wage_cash_for_cost += wage_cash

# ุฅุถุงูุฉ ุงููุตูุนูุฉ ูุชูููุฉ ุงููุจูุนุงุช
if total_wage_cash_for_cost > 0:
    total_cost_cash += total_wage_cash_for_cost
    
    create_dual_journal_entry(
        journal_entry_id=journal_entry.id,
        account_id=cost_of_sales_acc_id,
        cash_debit=total_wage_cash_for_cost,
        description="ุชูููุฉ ุงููุตูุนูุฉ"
    )
```

---

### 2. ุชุญุฏูุซ ุชูููุฉ ุงููุจูุนุงุช ุงููุฒููุฉ
**ุงูููู:** `backend/routes.py` (ุณุทูุฑ 2783-2830)

```python
# ุญุณุงุจ ุฅุฌูุงูู ุงููุตูุนูุฉ
total_wage_cash = 0.0

# ุงููุตูุนูุฉ ูู items
for item_data in data.get('items', []):
    item_wage = _to_float(item_data.get('wage', 0), 0.0)
    quantity = _to_float(item_data.get('quantity', 1), 1.0)
    total_wage_cash += item_wage * quantity

# ุงููุตูุนูุฉ ูู karat_lines
if karat_lines_data and isinstance(karat_lines_data, list):
    for line_data in karat_lines_data:
        wage_cash = _to_float(line_data.get('manufacturing_wage_cash', 0), 0.0)
        total_wage_cash += wage_cash

# ุชุญููู ุงููุตูุนูุฉ ุฅูู ูุฒู
wage_weight_equivalent = (total_wage_cash / direct_gold_price_main) if direct_gold_price_main > 0 else 0

# ุฅุถุงูุฉ ููุฏ ุชูููุฉ ุงููุจูุนุงุช ุงููุฒููุฉ
cost_account = db.session.query(Account).get(cost_of_sales_acc_id)
if cost_account and cost_account.memo_account_id:
    for karat, weight in gold_by_karat.items():
        if weight > 0 and total_weight_sold > 0:
            karat_proportion = weight / total_weight_sold
            
            # โ ุงูุชูููุฉ ุงููุฒููุฉ = ุงููุฒู ุงููุนูู + ุญุตุฉ ุงููุตูุนูุฉ ุงููุฒููุฉ
            karat_weight_cost = weight + (wage_weight_equivalent * karat_proportion)
            
            weight_params = {}
            weight_params[f'weight_{karat}k_debit'] = karat_weight_cost
            create_dual_journal_entry(
                journal_entry_id=journal_entry.id,
                account_id=cost_account.memo_account_id,
                **weight_params,
                description=f"ุชูููุฉ ูุจูุนุงุช ูุฒููุฉ (ูุฒู + ูุตูุนูุฉ) - ุนูุงุฑ {karat}"
            )
```

---

## ๐ ูุงุฆูุฉ ุงูุฏุฎู ุงูููุงุฆูุฉ

### โ ูุงุฆูุฉ ุงูุฏุฎู ุงูููุฏูุฉ (ุงูุฑุณููุฉ)
```
ุตุงูู ุงููุจูุนุงุช                    20,000 ุฑ.ุณ
ุชูููุฉ ุงููุจูุนุงุช:
  ูุฒู (80 ุฌู ร 150)               12,000
  ูุตูุนูุฉ                           3,500
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุฅุฌูุงูู ุงูุชูููุฉ                   15,500

ูุฌูู ุงูุฑุจุญ                        4,500
ูุตุฑููุงุช ุชุดุบูููุฉ                   1,000
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุตุงูู ุงูุฑุจุญ ุงูููุฏู                 3,500
```

### โก ูุงุฆูุฉ ุงูุฏุฎู ุงููุฒููุฉ (ุงูุชุญููููุฉ)
```
ุงููุจูุนุงุช ุงููุฒููุฉ
20,000 รท 200 =                   100.00 ุฌู

ุชูููุฉ ุงููุจูุนุงุช ุงููุฒููุฉ:
  ูุฒู ูุนูู ูุจุงุน                   80.00 ุฌู
  ูุตูุนูุฉ (3,500 รท 200)            17.50 ุฌู
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุฅุฌูุงูู ุงูุชูููุฉ ุงููุฒููุฉ            97.50 ุฌู

ูุฌูู ุงูุฑุจุญ ุงููุฒูู                  2.50 ุฌู

ูุตุฑููุงุช ุชุดุบูููุฉ:
1,000 รท 200 =                     5.00 ุฌู
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุตุงูู ุงูุฑุจุญ ุงููุฒูู                -2.50 ุฌู (ุฎุณุงุฑุฉ)
```

---

## ๐ก ุงูููุงุฆุฏ

### 1. ุฏูุฉ ูุญุงุณุจูุฉ
- โ ุชูููุฉ ุงููุจูุนุงุช ุงูููุฏูุฉ ุชุดูู ูู ุงูุชูุงููู ุงููุนููุฉ
- โ ุชุทุงุจู ูุน ุงููุนุงููุฑ ุงููุญุงุณุจูุฉ (GAAP/IFRS)

### 2. ุชุญููู ุฅุฏุงุฑู ุนููู
- โ ุงูุชูููุฉ ุงููุฒููุฉ ุชูุธูุฑ ุงูุชูููุฉ ุงูุญููููุฉ ุจุงูุฐูุจ
- โ ุชูุดู ุงูุฎุณุงุฑุฉ ุงููุฒููุฉ ุฑุบู ุงูุฑุจุญ ุงูููุฏู
- โ ุชุณุงุนุฏ ูู ุงุชุฎุงุฐ ูุฑุงุฑุงุช ุชุณุนูุฑ ุตุญูุญุฉ

### 3. ุดูุงููุฉ
- โ ุงููุตูุนูุฉ ูุงุถุญุฉ ูู ููุง ุงููุธุงููู
- โ ุณูููุฉ ุงูุชุฏููู ูุงููุฑุงุฌุนุฉ

---

## ๐งช ูุซุงู ุชุทุจููู

### ุงููุฏุฎูุงุช
- ุจูุน: 20,000 ุฑ.ุณ
- ูุฒู: 80 ุฌู
- ูุตูุนูุฉ: 3,500 ุฑ.ุณ
- ูุตุฑููุงุช: 1,000 ุฑ.ุณ
- ุงูุณุนุฑ ุงููุจุงุดุฑ: 200 ุฑ.ุณ/ุฌู

### ุงููุฎุฑุฌุงุช

**ุงูููุฏูุฉ:**
- ุงูุฑุจุญ = 20,000 - 15,500 - 1,000 = **3,500 ุฑ.ุณ** โ

**ุงููุฒููุฉ:**
- ุงูุฑุจุญ = 100 - 97.5 - 5 = **-2.5 ุฌู** (ุฎุณุงุฑุฉ) โ๏ธ

### ุงูุชูุณูุฑ
ุฑุบู ุชุญููู ุฑุจุญ ููุฏู 3,500 ุฑ.ุณุ ุฅูุง ุฃู ุงูุชุงุฌุฑ ุฎุณุฑ ูุนูููุง 2.5 ุฌู ูู ุงูุฐูุจ ุจุณุจุจ:
- ุงููุตูุนูุฉ ุงููุฑุชูุนุฉ
- ุงููุตุฑููุงุช ุงูุชุดุบูููุฉ

---

## โ ุงูุฎูุงุตุฉ

### ุงููุงุนุฏุฉ ุงูุฐูุจูุฉ ุงูููุงุฆูุฉ

๐น **ุงููุฎุฒูู** โ ูุฒู ุญูููู ููุท  
๐น **ุงููุตูุนูุฉ** โ ููุฏ + ูุฒู ุชุญูููู  
๐น **ุงูุฑุจุญ ุงููุฒูู** โ ููุฒุงู ุฐูุจ ุญูููู  
๐น **ุงูุณุนุฑ ุงููุจุงุดุฑ** โ ุฃุฏุงุฉ ููุงุณ ูุง ุฃูุซุฑ  

---

## ๐ ููุงุญุธุงุช ูููุทูุฑูู

1. ุงููุตูุนูุฉ ุชูุญุณุจ ูู ูุตุฏุฑูู:
   - `items[].wage` (ููู ุตูู)
   - `karat_lines[].manufacturing_wage_cash` (ููุฃูุฒุงู ุงููุฌูุนุฉ)

2. ุงูุณุนุฑ ุงููุจุงุดุฑ ุงููุณุชุฎุฏู:
   - `price_per_gram_main_karat` (ุณุนุฑ ุงูุนูุงุฑ ุงูุฑุฆูุณู ุจุงูุฑูุงู)
   - ููุญุณุจ ูู: `(price_24k ร main_karat) / 24`

3. ุงููููุฏ ุงููุญุงุณุจูุฉ:
   - ุงูููุฏูุฉ: ุญู/50 (ุชูููุฉ ุงููุจูุนุงุช)
   - ุงููุฒููุฉ: ุญู/7500 (ูุฐูุฑุฉ ุชูููุฉ ุงููุจูุนุงุช)

---

**ุชู ุจูุฌุงุญ โ**
