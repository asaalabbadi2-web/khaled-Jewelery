# ๐ ุญูุงูุฉ ุงูุญุณุงุจุงุช ุงููุฒููุฉ ูู ุงูุฅููุงู ุงูุณููู

## ๐ ุงููุงุนุฏุฉ ุงูุฐูุจูุฉ

**ุงูุญุณุงุจุงุช ุงููุฒููุฉ ูุง ุชูููู ูู ููุงูุฉ ุงูุณูุฉ ุงููุงููุฉุ ุจู ุชูุฑุญูู ูุฃุฑุตุฏุฉ**

---

## ๐ฏ ููุงุฐุงุ

### 1๏ธโฃ ุงูุญุณุงุจุงุช ุงููุฒููุฉ ุชุชุจุน **ุงููููุงุช** ูููุณ **ุงููููุฉ**
- ุงููุฒู ูุง ููุตููุฑ ูู ููุงูุฉ ุงูุณูุฉ
- ุงูุฐูุจ ุงูููุฌูุฏ ูุนููุงู ูุจูู ููุฌูุฏุงู
- ุงููุฒู ููุณ ูู "ุฃุฑุจุงุญ ูุญุชุฌุฒุฉ" ุฃู "ุฎุณุงุฆุฑ ูุญููุฉ"

### 2๏ธโฃ ุงูุญุณุงุจุงุช ุงููุฐูุฑุฉ (Memo Accounts) ูุซู 7521
- ุญุณุงุจ 7521 (ุญุณุงุจ ูุฐูุฑุฉ ุงููุฎุฒูู) ูุชุชุจุน ุงููุฒู ููุท
- ูุง ูููุฉ ููุฏูุฉ ูู
- ููุณุชุฎุฏู ูููุฑุงูุจุฉ ูุงูุชุฏููู

### 3๏ธโฃ ุญุณุงุจุงุช ุงูููุฑุฏูู ูุงูุนููุงุก ุงููุฒููุฉ
- ุงูููุฑุฏ ุฏุงุฆู ุจู 100 ุฌุฑุงู ุนูุงุฑ 21 ูู ููุงูุฉ ุงูุณูุฉ
- ูุจูู ุฏุงุฆูุงู ุจููุณ ุงููุฒู ูู ุจุฏุงูุฉ ุงูุณูุฉ ุงูุฌุฏูุฏุฉ
- ูุง ููุญููู ุฅูู "ุฃุฑุจุงุญ ูุญุชุฌุฒุฉ ูุฒููุฉ" (ูุง ููุฌุฏ ุดูุก ุงุณูู!)

---

## ๐ก๏ธ ุงูุญุณุงุจุงุช ุงููุญููุฉ ูู ุงูุฅููุงู

### โ ุฃู ุญุณุงุจ ูุญูู ุฃุญุฏ ุงูุดุฑูุท ุงูุชุงููุฉ:

1. **`tracks_weight = True`**
   - ุฃู ุญุณุงุจ ูุชุชุจุน ุงููุฒู
   - ูุซุงู: ุญุณุงุจุงุช ุงูููุฑุฏููุ ุญุณุงุจุงุช ุงูุนููุงุกุ ุญุณุงุจุงุช ุงููุฎุฒูู ุงููุฒููุฉ

2. **`transaction_type = 'gold'`**
   - ุฃู ุญุณุงุจ ูู ุงูุดุฌุฑุฉ ุงููุฒููุฉ
   - ูุซุงู: ุฌููุน ุงูุญุณุงุจุงุช ูู ุดุฌุฑุฉ ุงูุฐูุจ (7XXX)

3. **`account_number = '7521'`**
   - ุญุณุงุจ ูุฐูุฑุฉ ุงููุฎุฒูู (ุญุณุงุจ ุฎุงุต)
   - ูุฌุจ ุนุฏู ุฅููุงูู ุฃุจุฏุงู

4. **ุญุณุงุจุงุช ุงูุฌุณุฑ (Bridge Accounts)**
   - ุญุณุงุจุงุช ุงูุฌุณุฑ ูุฌุจ ุฃู ุชููู ุตูุฑูุฉ ุฏุงุฆูุงู
   - ููู ูุง ุชููููุ ุจู ุชูุฑุงูุจ

---

## ๐ง ุงูุชุทุจูู ูู ุงููุธุงู

### 1. ุญูุงูุฉ ุชููุงุฆูุฉ ูู ุนูููุงุช ุงูุฅููุงู

```python
# ูู ุฃู ุฏุงูุฉ ุฅููุงู ุณููู ูุณุชูุจููุฉ
def close_fiscal_year():
    """ุฅููุงู ุงูุณูุฉ ุงููุงููุฉ (ุงูููุฏูุฉ ููุท)"""
    
    # ุฌูุจ ุงูุญุณุงุจุงุช ุงููุงุจูุฉ ููุฅููุงู (ููุฏูุฉ ููุท)
    closable_accounts = Account.query.filter(
        Account.transaction_type == 'cash',  # ููุฏูุฉ ููุท
        Account.tracks_weight == False,      # ูุง ุชุชุจุน ุงููุฒู
        Account.account_number != '7521'     # ููุณุช ุงูุญุณุงุจ ุงููุฐูุฑุฉ
    ).all()
    
    # ุฅููุงู ุงูุญุณุงุจุงุช ุงูููุฏูุฉ ููุท
    for account in closable_accounts:
        if account.type in ['revenue', 'expense']:
            # ููู ุงูุฑุตูุฏ ุฅูู ุงูุฃุฑุจุงุญ ุงููุญุชุฌุฒุฉ
            transfer_to_retained_earnings(account)
```

### 2. ุชุญุฐูุฑ ุนูุฏ ูุญุงููุฉ ุงูุฅููุงู

```python
def validate_closing_eligibility(account_id):
    """ุงูุชุญูู ูู ุฃูููุฉ ุงูุญุณุงุจ ููุฅููุงู"""
    
    account = Account.query.get(account_id)
    
    # ุงูุญุณุงุจุงุช ุงูููููุนุฉ ูู ุงูุฅููุงู
    if account.tracks_weight:
        raise ValueError(
            f"โ ุงูุญุณุงุจ {account.account_number} ({account.name}) "
            f"ูุชุชุจุน ุงููุฒู ููุง ูููู ุฅููุงูู. "
            f"ุงูุฃุฑุตุฏุฉ ุงููุฒููุฉ ุชูุฑุญูู ููุณูุฉ ุงูุชุงููุฉ."
        )
    
    if account.transaction_type == 'gold':
        raise ValueError(
            f"โ ุงูุญุณุงุจ {account.account_number} ({account.name}) "
            f"ูู ุงูุดุฌุฑุฉ ุงููุฒููุฉ ููุง ูููู ุฅููุงูู."
        )
    
    if account.account_number == '7521':
        raise ValueError(
            f"โ๏ธ ุญุณุงุจ ูุฐูุฑุฉ ุงููุฎุฒูู (7521) ูุญูู ูู ุงูุฅููุงู."
        )
    
    return True
```

### 3. ุชูุฑูุฑ ุงูุฃุฑุตุฏุฉ ุงููุฑุญููุฉ

```python
@api.route('/reports/weight-balances-carryforward', methods=['GET'])
def get_weight_balances_carryforward():
    """
    ุชูุฑูุฑ ุงูุฃุฑุตุฏุฉ ุงููุฒููุฉ ุงููุฑุญููุฉ ููุณูุฉ ุงูุฌุฏูุฏุฉ
    
    ูุนุฑุถ:
    - ุฌููุน ุงูุญุณุงุจุงุช ุงููุฒููุฉ
    - ุฃุฑุตุฏุชูุง ูู ููุงูุฉ ุงูุณูุฉ ุงูุญุงููุฉ
    - ุชุฃููุฏ ุชุฑุญูููุง ููุณูุฉ ุงูุชุงููุฉ
    """
    
    weight_accounts = Account.query.filter(
        or_(
            Account.tracks_weight == True,
            Account.transaction_type == 'gold',
            Account.account_number == '7521'
        )
    ).all()
    
    balances = []
    for account in weight_accounts:
        balances.append({
            'account_number': account.account_number,
            'account_name': account.name,
            'balance_18k': round(account.balance_18k or 0.0, 3),
            'balance_21k': round(account.balance_21k or 0.0, 3),
            'balance_22k': round(account.balance_22k or 0.0, 3),
            'balance_24k': round(account.balance_24k or 0.0, 3),
            'notes': 'โ ููุฑุญูู ููุง ูู ููุณูุฉ ุงูุชุงููุฉ'
        })
    
    return jsonify({
        'report_type': 'weight_balances_carryforward',
        'fiscal_year_end': datetime.now().year,
        'next_fiscal_year': datetime.now().year + 1,
        'weight_accounts': balances,
        'notes': [
            '๐ ุงูุฃุฑุตุฏุฉ ุงููุฒููุฉ ูุง ุชูููู',
            '๐ ุชูุฑุญูู ููุง ูู ููุณูุฉ ุงููุงููุฉ ุงูุชุงููุฉ',
            'โ๏ธ ูุง ุชูุฌุฏ "ุฃุฑุจุงุญ ูุญุชุฌุฒุฉ ูุฒููุฉ"',
            'โ ููุท ุงูุญุณุงุจุงุช ุงูููุฏูุฉ ุชูููู ูู ููุงูุฉ ุงูุณูุฉ'
        ]
    })
```

---

## ๐ ููุงุฑูุฉ: ุงูุญุณุงุจุงุช ุงูููุฏูุฉ vs ุงููุฒููุฉ

| ุงูุฎุงุตูุฉ | ุงูุญุณุงุจุงุช ุงูููุฏูุฉ | ุงูุญุณุงุจุงุช ุงููุฒููุฉ |
|---------|------------------|------------------|
| **ุงูุฅููุงู ุงูุณููู** | โ ุชูููู | โ ูุง ุชูููู |
| **ุงูุชุฑุญูู** | ุงููููุฉ ุงูููุฏูุฉ ุชูุตููุฑ | ุงููุฒู ููุฑุญูู ููุง ูู |
| **ุงูุฃุฑุจุงุญ ุงููุญุชุฌุฒุฉ** | โ ุชูุญุณุจ | โ ูุง ุชูุญุณุจ |
| **ุญุณุงุจ ุงูุฎุชุงูู** | โ ูุธูุฑ | โ ูุง ูุธูุฑ |
| **ุงูููุฒุงููุฉ ุงูุงูุชุชุงุญูุฉ** | ุฑุตูุฏ ุฌุฏูุฏ | ููุณ ุงูุฑุตูุฏ ุงููุฏูู |
| **ุงููุนูุงุฑ ุงููุญุงุณุจู** | IFRS/GAAP | ูุนูุงุฑ ุฎุงุต ุจุชุฌุงุฑุฉ ุงูุฐูุจ |

---

## ๐งช ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

### โ ุณููุงุฑูู 1: ุฅููุงู ุณูุฉ ูุงููุฉ
```
ุงููุฏุฎูุงุช:
- ููุงูุฉ ุงูุณูุฉ: 31/12/2025
- ุญุณุงุจ 1310 (ูุฎุฒูู ุฐูุจ 21) - ุฑุตูุฏ: 50 ุฌุฑุงู

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
- ุงูุฑุตูุฏ ูู 01/01/2026: 50 ุฌุฑุงู (ูู ูุชุบูุฑ)
- ูุง ูููุดุฃ ููุฏ ุฅููุงู ููุฐุง ุงูุญุณุงุจ
```

### โ ุณููุงุฑูู 2: ุญุณุงุจ ููุฑุฏ ูุฒูู
```
ุงููุฏุฎูุงุช:
- ุญุณุงุจ ููุฑุฏ (ูุชุชุจุน ุงููุฒู) - ุฏุงุฆู ุจู 100 ุฌุฑุงู ุนูุงุฑ 21

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
- ูู ุงูุณูุฉ ุงูุฌุฏูุฏุฉ: ูุจูู ุฏุงุฆูุงู ุจู 100 ุฌุฑุงู
- ูุง ููุญููู ุฅูู ุญุณุงุจ ููุฏู
```

### โ ุณููุงุฑูู 3: ูุญุงููุฉ ุฅููุงู ุญุณุงุจ 7521
```
ุงููุฏุฎูุงุช:
- ูุญุงููุฉ ุฅููุงู ุญุณุงุจ 7521 (ูุฐูุฑุฉ ุงููุฎุฒูู)

ุงููุชูุฌุฉ ุงููุชููุนุฉ:
- ุฎุทุฃ: "โ๏ธ ุญุณุงุจ ูุฐูุฑุฉ ุงููุฎุฒูู (7521) ูุญูู ูู ุงูุฅููุงู"
- ุงูุนูููุฉ ุชูุดู
```

---

## ๐ ูุงุฆูุฉ ุงูุชุญูู (Checklist) ูููุงูุฉ ุงูุณูุฉ

### โ ูุจู ุงูุฅููุงู:
- [ ] ุงูุชุฃูุฏ ูู ุฃู ุฌููุน ุงูููุงุชูุฑ ูุฑุญููุฉ
- [ ] ุงูุชุญูู ูู ุชูุงุฒู ุงููููุฏ ุงููุฒุฏูุฌุฉ
- [ ] ูุฑุงุฌุนุฉ ุฑุตูุฏ ุญุณุงุจ ุงูุฌุณุฑ (ูุฌุจ ุฃู ูููู = ุตูุฑ)
- [ ] ุทุจุงุนุฉ ุชูุฑูุฑ ุงูุฃุฑุตุฏุฉ ุงููุฒููุฉ

### โ ุฎูุงู ุงูุฅููุงู:
- [ ] ุฅููุงู ุงูุญุณุงุจุงุช ุงูููุฏูุฉ ููุท (ุฅูุฑุงุฏุงุช ููุตุฑููุงุช)
- [ ] ุนุฏู ุงููุณุงุณ ุจุงูุญุณุงุจุงุช ุงููุฒููุฉ
- [ ] ุฅูุดุงุก ููุฏ ุงูุฃุฑุจุงุญ ุงููุญุชุฌุฒุฉ (ููุฏู ููุท)

### โ ุจุนุฏ ุงูุฅููุงู:
- [ ] ุงูุชุฃูุฏ ูู ุฃู ุงูุฃุฑุตุฏุฉ ุงููุฒููุฉ ูู ุชุชุบูุฑ
- [ ] ุทุจุงุนุฉ ุงูููุฒุงููุฉ ุงูุงูุชุชุงุญูุฉ (ููุญุณุงุจุงุช ุงูููุฏูุฉ)
- [ ] ุทุจุงุนุฉ ุชูุฑูุฑ ุงูุฃุฑุตุฏุฉ ุงููุฒููุฉ ุงููุฑุญููุฉ

---

## ๐จ ุชุญุฐูุฑุงุช ูููุฉ

### โ๏ธ ูุง ุชูุนู ูุฐุง ุฃุจุฏุงู:
1. โ ุฅููุงู ุญุณุงุจุงุช ุงููุฎุฒูู ุงููุฒููุฉ
2. โ ุชุตููุฑ ุฃุฑุตุฏุฉ ุงูููุฑุฏูู/ุงูุนููุงุก ุงููุฒููุฉ
3. โ ุญุฐู ุญุณุงุจ 7521 ุฃู ุฅููุงูู
4. โ ุชุญููู ุงูุฃุฑุตุฏุฉ ุงููุฒููุฉ ุฅูู ููุฏูุฉ ูู ููุงูุฉ ุงูุณูุฉ

### โ ุงูุนู ูุฐุง ุจุฏูุงู:
1. โ ุฑุญูู ุงูุฃุฑุตุฏุฉ ุงููุฒููุฉ ููุง ูู
2. โ ุฃููู ุงูุญุณุงุจุงุช ุงูููุฏูุฉ ููุท
3. โ ุฑุงูุจ ุญุณุงุจ ุงูุฌุณุฑ (ูุฌุจ ุฃู ูููู ุตูุฑ)
4. โ ุงุญุชูุธ ุจุชูุฑูุฑ ุงูุฃุฑุตุฏุฉ ุงููุฒููุฉ ูููุฑุงุฌุนุฉ

---

## ๐ ูุฑุงุฌุน ุฅุถุงููุฉ

- `POSTING_SYSTEM_GUIDE.md` - ูุธุงู ุงูุชุฑุญูู ุงููุญุงุณุจู
- `UNIFIED_THEME_SYSTEM.md` - ุงููุธุงู ุงููุญุงุณุจู ุงููุฒุฏูุฌ
- `backend/config.py` - ุฅุนุฏุงุฏุงุช ุงูุนูุงุฑุงุช ูุงูุฃูุฒุงู
- `backend/dual_system_helpers.py` - ุฏูุงู ุงููุธุงู ุงููุฒุฏูุฌ

---

**ุขุฎุฑ ุชุญุฏูุซ:** 15 ุฏูุณูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 1.0  
**ููุงุญุธุฉ:** ูุฐู ูุงุนุฏุฉ ูุญุงุณุจูุฉ ุฃุณุงุณูุฉ ูุง ูุฌุจ ุชุฌุงูููุง ูู ุชุฌุงุฑุฉ ุงูุฐูุจ
